{{ define "main" }}
{{ $allPages := .Pages }}

{{ $sliderPosts := first 3 $allPages }}
<section class="bg-base-200 pb-12 transition-colors duration-500">
  <div class="relative w-full h-[500px] overflow-hidden group">
    <div id="carousel-track" class="relative w-full h-full">
      
      {{ range $index, $element := $sliderPosts }}
      <div class="carousel-slide absolute inset-0 transition-opacity duration-700 ease-in-out {{ if eq $index 0 }}opacity-100 z-10{{ else }}opacity-0 z-0{{ end }}" data-index="{{ $index }}">
        
        {{ with .Params.image }}
          {{ with $element.Resources.Get . }}
            <img src="{{ .RelPermalink }}" alt="{{ $element.Title }}" class="absolute inset-0 w-full h-full object-cover">
          {{ end }}
        {{ end }}
        
        <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/40 to-transparent"></div>

        <div class="absolute bottom-0 left-0 w-full p-8 md:p-16 max-w-4xl">
           <h2 class="text-3xl md:text-5xl font-extrabold text-white mb-4 leading-tight drop-shadow-lg">
            <a href="{{ $element.RelPermalink }}" class="hover:underline decoration-primary decoration-4">
              {{ $element.Title }}
            </a>
          </h2>
          </div>
      </div>
      {{ end }}
    </div>
    <button id="prevBtn" class="absolute top-1/2 left-4 z-20 p-3 rounded-full bg-black/30 text-white hover:bg-primary">❮</button>
    <button id="nextBtn" class="absolute top-1/2 right-4 z-20 p-3 rounded-full bg-black/30 text-white hover:bg-primary">❯</button>
  </div>
</section>

<div class="bg-base-200 min-h-screen pb-20">
  <div class="mx-auto max-w-7xl px-6 grid grid-cols-1 lg:grid-cols-12 gap-12 pt-12">
    <div class="lg:col-span-8 flex flex-col gap-16">

      <section>
        <h3 class="text-2xl font-bold text-base-content border-l-4 border-base-content/20 pl-4 mb-8">
          Últimas Publicações
        </h3>

        <div class="grid md:grid-cols-2 gap-8">
          {{ range after 3 $allPages }}
          <article class="flex flex-col bg-base-100 rounded-2xl overflow-hidden shadow-sm border border-base-300 hover:shadow-lg transition-all duration-300">
            
            {{ with .Params.image }}
              {{ with $.Resources.Get . }}
              <a href="{{ $.RelPermalink }}" class="aspect-video overflow-hidden block bg-base-300">
                <img src="{{ .RelPermalink }}" alt="{{ $.Title }}" class="w-full h-full object-cover transition-transform duration-500 hover:scale-105">
              </a>
              {{ end }}
            {{ end }}
            
            <div class="p-6 flex flex-col flex-1">
               <h2 class="text-lg font-bold text-base-content mb-3 leading-snug group">
                <a href="{{ .RelPermalink }}" class="group-hover:text-primary transition-colors">
                  {{ .Title }}
                </a>
              </h2>
              <p class="text-base-content/70 text-sm line-clamp-3 mb-4 flex-1">
                {{ .Params.description }}
              </p>
              </div>
          </article>
          {{ end }}
        </div>
      </section>
    </div>
    {{ partial "sidebar.html" . }} 
    </div>
</div>
{{ end }}